#! /bin/sh

SMBW_LIBDIR=${SMBW_LIBDIR-@builddir@/smbwrapper}

if [ ! -f ${SMBW_LIBDIR}/smbwrapper.so ]; then
    echo You need to set LIBDIR in smbsh
    exit
fi

# a simple launcher for the smbwrapper.so preloadde library

if [ x"${SMBW_USER+set}" != x"set" ]; then
    echo username?
    read user
    SMBW_USER=$user
    export SMBW_USER
fi

# this doesn't hide the password - we need a proper launch app for that
if [ x"${SMBW_PASSWORD+set}" != x"set" ]; then
    echo password?
    read pass
    SMBW_PASSWORD=$pass
    export SMBW_PASSWORD
fi

PWD=`pwd`
export PWD
PS1='smbsh$ '
export PS1

LD_PRELOAD=$SMBW_LIBDIR/smbwrapper.so
export LD_PRELOAD

exec ${SMBW_SHELL-${SHELL-/bin/sh}} ${1+"$@"}
