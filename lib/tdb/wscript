VERSION='1.2.1'

srcdir = '../..'
blddir = 'bin'

LIBREPLACE_DIR= srcdir + '/lib/replace'

def set_options(opt):
    opt.recurse(LIBREPLACE_DIR)

def configure(conf):
    conf.sub_config(LIBREPLACE_DIR)
    conf.SAMBA_CONFIG_H()

def build(bld):
    bld.BUILD_SUBDIR(LIBREPLACE_DIR)

    COMMON_SRC = bld.SUBDIR('common',
                            '''check.c error.c tdb.c traverse.c
                            freelistcheck.c lock.c dump.c freelist.c
                            io.c open.c transaction.c''')

    bld.SAMBA_LIBRARY('tdb',
                      COMMON_SRC,
                      deps='replace',
                      include_list='include',
                      vnum=VERSION)

    bld.SAMBA_BINARY('tdbtorture',
                     'tools/tdbtorture.c',
                     'tdb')

    bld.SAMBA_BINARY('tdbdump',
                     'tools/tdbdump.c',
                     'tdb')

    bld.SAMBA_BINARY('tdbbackup',
                     'tools/tdbbackup.c',
                     'tdb')

    bld.SAMBA_BINARY('tdbtool',
                     'tools/tdbtool.c',
                     'tdb')
