HEADERS = \
	asn1.h asn1_err.h bits.h cache.h config_file.h \
	des.h error.h getarg.h gssapi.h hdb.h hdb_asn1.h hdb_err.h \
	keytab.h krb5.h krb5_err.h md4.h md5.h roken.h \
	sha.h sl.h store.h

MAYBE_HEADERS = \
	err.h

srcdir		= @srcdir@
VPATH		= $(srcdir)
top_srcdir 	= @top_srcdir@
prefix		= @prefix@
includedir	= @includedir@
CC		= @CC@
INSTALL		= @INSTALL@
INSTALL_DATA	= @INSTALL_DATA@
CFLAGS		= @CFLAGS@
DEFS		= -DHOST=\"@CANONICAL_HOST@\" 
LN_S		= @LN_S@
HAVE_ERR_H	= @ac_cv_header_err_h@
mkinstalldirs	= $(SHELL) $(top_srcdir)/mkinstalldirs

all:
	for i in $(HEADERS) $(MAYBE_HEADERS); do \
	if test ! -h $$i -a ! -f $$i ; then X="$$X $$i"; fi \
	done; \
	if test -n "$$X" ; then $(MAKE) $$X; fi

install:
	$(mkinstalldirs) $(includedir)
	for i in $(HEADERS); \
	  do $(INSTALL_DATA) $$i $(includedir)/$$i; done
	-if test "$(HAVE_ERR_H)" != yes; then \
	  $(INSTALL_DATA) err.h $(includedir)/err.h; \
	fi

uninstall:
	for x in $(HEADERS); do \
	  rm -f $(includedir)/$$x; \
	done
	-if test "$(HAVE_ERR_H)" != yes; then \
	  rm -f $(includedir)/err.h; \
	fi

.c.o:
	$(CC) $(CFLAGS) $(DEFS) -c $< 

clean:
	rm -f $(HEADERS) bits *.o core

krb5.h:
	$(LN_S) $(top_srcdir)/lib/krb5/krb5.h .

krb5_err.h:
	$(LN_S) ../lib/error/krb5_err.h .

asn1_err.h:
	$(LN_S) ../lib/error/asn1_err.h .

hdb_err.h:
	$(LN_S) ../lib/error/hdb_err.h .

err.h:
	if test "$(HAVE_ERR_H)" != yes; then \
	  $(LN_S) $(top_srcdir)/lib/roken/err.h err.h; \
	fi || true

getarg.h:
	$(LN_S) $(top_srcdir)/lib/roken/getarg.h .

error.h:
	$(LN_S) $(top_srcdir)/lib/error/error.h .

cache.h:
	$(LN_S) $(top_srcdir)/lib/krb5/cache.h .

keytab.h:
	$(LN_S) $(top_srcdir)/lib/krb5/keytab.h .

config_file.h:
	$(LN_S) $(top_srcdir)/lib/krb5/config_file.h .

asn1.h:
	$(LN_S) ../lib/asn1/asn1.h .

des.h:
	$(LN_S) $(top_srcdir)/lib/des/des.h .

hdb.h:
	$(LN_S) $(top_srcdir)/lib/hdb/hdb.h .

hdb_asn1.h:
	$(LN_S) ../lib/hdb/hdb_asn1.h .

md4.h:
	$(LN_S) $(top_srcdir)/lib/des/md4.h .

md5.h:
	$(LN_S) $(top_srcdir)/lib/des/md5.h .

sha.h:
	$(LN_S) $(top_srcdir)/lib/des/sha.h .

store.h:
	$(LN_S) $(top_srcdir)/lib/krb5/store.h .

gssapi.h:
	$(LN_S) $(top_srcdir)/lib/gssapi/gssapi.h .

roken.h:
	$(LN_S) $(top_srcdir)/lib/roken/roken.h .

sl.h:
	$(LN_S) $(top_srcdir)/lib/sl/sl.h .

bits.h: bits
	./bits bits.h

bits: bits.o
	$(CC) -o bits bits.o

