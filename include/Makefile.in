HEADERS = krb5.h krb5_err.h asn1_err.h hdb_err.h asn1.h des.h hdb.h md4.h \
	bits.h cache.h keytab.h config_file.h store.h

srcdir	= @srcdir@
VPATH	= $(srcdir)
top_srcdir = @top_srcdir@
CC	= @CC@
CFLAGS	= @CFLAGS@
DEFS	= -DHOST=\"@CANONICAL_HOST@\" 

LN_S = ln -s

all:
	for i in $(HEADERS); do \
	if test ! -h $$i -a ! -f $$i ; then X="$$X $$i"; fi \
	done; \
	if test ! -z "$$X" ; then $(MAKE) $$X; fi

.c.o:
	$(CC) $(CFLAGS) $(DEFS) -c $< 

clean:
	rm -f $(HEADERS) bits *.o core

krb5.h:
	$(LN_S) $(top_srcdir)/lib/krb5/krb5.h .

krb5_err.h:
	$(LN_S) ../lib/krb5/error/krb5_err.h .

asn1_err.h:
	$(LN_S) ../lib/krb5/error/asn1_err.h .

hdb_err.h:
	$(LN_S) ../lib/krb5/error/hdb_err.h .

cache.h:
	$(LN_S) $(top_srcdir)/lib/krb5/cache.h .

keytab.h:
	$(LN_S) $(top_srcdir)/lib/krb5/keytab.h .

config_file.h:
	$(LN_S) $(top_srcdir)/lib/krb5/config_file.h .

asn1.h:
	$(LN_S) ../lib/asn1/asn1.h .

des.h:
	$(LN_S) $(top_srcdir)/lib/des/des.h .

hdb.h:
	$(LN_S) $(top_srcdir)/lib/hdb/hdb.h .

md4.h:
	$(LN_S) $(top_srcdir)/lib/des/md4.h .

store.h:
	$(LN_S) $(top_srcdir)/lib/krb5/store.h .

bits.h: bits
	./bits bits.h

bits: bits.o
	$(CC) -o bits bits.o

