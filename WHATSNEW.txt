                   =================================
                   Release Notes for Samba 3.3.0pre2
                          September 30, 2008
                   =================================

This is the second preview release of Samba 3.3.0.  This is *not*
intended for production environments and is designed for testing
purposes only.  Please report any defects via the Samba bug reporting
system at https://bugzilla.samba.org/.

Major enhancements in Samba 3.3.0 include:

 Configuration/installation:
 o Splitting of library directory into library directory and separate
   modules directory.

 File Serving:
 o Extended Cluster support.

 Winbind:
 o Simplyfied idmap configuration.
 o Added new parameter "winbind reconnect delay".
 o Added support for user and group aliasing.

 Administrative tools:
 o The destination "all" of smbcontrol does now affect all running
   daemons including nmbd and winbindd.
 o New 'net rpc vampire keytab' and 'net rpc vampire ldif' commands.
 o The 'net' utility can now use kerberos for joining and authentication.

 Libraries:
 o NetApi library implements various new calls for User- and Group
   Account Management.


Configure changes
=================

The configure option "--with-libdir" has been removed. The library
directory can still be specified by using the existing "--libdir" option.
A new option "--with-modulesdir" has been added to allow the specification
of a separate directory for the shared modules.


Winbind idmap backend changes
=============================

The idmap configuration has changed with version 3.3 to something that
allows a smoother upgrade path from pre-3.0.25 configurations that use
"idmap backend". The reason for this change is that to many, also to Samba
developers, the 3.0.25 style configuration with "idmap config" turned out
to be very complex. Version 3.3 no longer deprecates the "idmap backend"
parameter, instead with "idmap backend" the default idmap backend is
specified.

Accordingly, the "idmap config <domain> : default = yes" setting is no
longer being looked at.

The alloc backend defaults to the default backend, which should be able to
allocate IDs. In the default distribution the tdb and ldap backends can
allocate, the ad and rid backends can not. The idmap alloc range is now
being set with the "old" parameters "idmap uid" and "idmap gid".

The "idmap domains" parameter has been removed.


winbind reconnect delay
=======================

This is a new parameter which specifies the number of seconds the Winbind
daemon will wait between attempts to contact a Domain controller for a domain
that is determined to be down or not contactable.


######################################################################
Changes
#######

smb.conf changes
----------------

    Parameter Name                      Description     Default
    --------------                      -----------     -------
    idmap domains			Removed
    init logon delayed hosts		New		""
    init logon delay			New		100
    winbind reconnect delay		New		30


Changes since 3.3.0pre1:
------------------------


o   Michael Adam <obnox@samba.org>

    * BUG 5492: Fix RHEL SPEC file by removing libmsrpc stuff.
    * BUG 5507: Fix several issues in the RHEL SPEC file.

o   Jeremy Allison <jra@samba.org>
    * BUG 5729: Explicitly allow "-valid".
    * BUG 5751: Fix showing of ACLs on DFS in (lib)smbclient.
    * BUG 5762: Fix opening of mangled directory name (resulted
      'is a stream name').
    * Fix crashes when looking up a non-existant uid.
    * Fix getting/setting of NT ACLs on a file.
    * Add st_birthtime and friends for accurate create times on *BSD
      and MacOSX).
    * Fix the wcache_invalidate_samlogon calls.
    * Clarify usage of "force create mode".
    * Get smbd to look (read-only) into the winbindd cache for uid/gid <--> sid
      mappings.
    * Write times code update.
    * Add experimental version of VFS module acl_xattr.


o   Gerald W. Carter <jerry@samba.org>
    * Fix segfault when calling nss_get_info() with a NULL ads structure.
    * Add support for name aliasing in Winbind.
    * Add the idmap/nss-info provider from Likewise Open.
    * Allow an admin to define the "uid" attribute for a RFC2307
      user object in AD to be the username alias.


o   Steven Danneman <steven.danneman@isilon.com>
    * Fix build warnings.
    * Cleanup of DC enumeration in get_dcs().


o   GÃ¼nther Deschner <gd@samba.org>
    * BUG 5710: Fix changing of machine account passwords.
    * Fix invalid sid copy (hit when enumerating sibling domains) in Winbind.
    * Fix double installation of cifs.upcall.


o   James Ding <ding_cc@hotmail.com>
    * BUG 5736: Fix Winbind crash bug with trusted domains.


o   Ephi Dror <Ephi.Dror@datadomain.com>
    * Correct the netsamlogon_clear_cached_user function.


o   Jeff Layton <jlayton@redhat.com>
    * Fix build warnings in cifs.upcall.


o   Volker Lendecke <vl@sernet.de>
    * Fix Coverity IDs 587 and 589.
    * Increase the default positive idmap cache time to a week.
    * BUG 5707: Do proper error handling if the socket is closed.
    * Fix calculation of useable_space for trans2 and nttrans replies.
    * Add mapping of generic bits when setting an NFSv4 ACL.


o   Stefan Metzmacher <metze@samba.org>
    * Some write time fixes.


o   Simo Sorce <idra@samba.org>
    * Fix enumeration of nested group memberships in Winbind.
      This affected only setups using "security = ads".


o   Timur <timur@FreeBSD.org>
    * Fix cut and paste error in quota code.
    * Fix display of POSIX ACLs.
    * Fix aio on FreeBSD.


o   Andrew Tridgell <tridge@samba.org>
    * Fix permissions of group_mapping.ldb (CVE-2008-3789).
    * Avoid a race condition in glibc between AIO and setresuid().
    * Add missing become root for AIO operations.
    * Fix an errno handling bug that could lead to an infinite loop.
    * Fix logic of tsmsm_sendfile().
    * Fix handling of arbitrary new PAC types.


o   Qiao Yang <geoyang@ironport.com>
    * Fix a memleak.


Commit Highlights:
------------------

o   Michael Adam <obnox@samba.org>
    * BUG 5609: Remove configure option "--with-libdir" and add
      "--with-modulesdir".
    * Extend "net rpc vampire keytab" to support differential replication
      and storing of kerberos keys.
    * Rework internal logic of registry tdb code.
    * Freeze autogenerated prototype headers (good bye "make proto").


o   Jeremy Allison <jra@samba.org>
    * Add new "winbind reconnect delay" parameter.
    * Make the change to smbcontrol for "all" to mean broadcast,
      and "smbd" to mean the main smb daemon.


o   Guenther Deschner <gd@samba.org>
    * BUG 5710: Fix changing of machine account passwords.
    * Add "net rpc vampire keytab" and "net rpc vampire ldif".


o   Volker Lendecke <vl@samba.org>
    * Rework of the Winbind idmap backend.
    * Fix calculation of useable_space for trans2 and nttrans replies.
    * Add mapping of generic bits when setting an NFSv4 ACL.


######################################################################
Reporting bugs & Development Discussion
#######################################

Please discuss this release on the samba-technical mailing list or by
joining the #samba-technical IRC channel on irc.freenode.net.

If you do report problems then please try to send high quality
feedback. If you don't provide vital information to help us track down
the problem then you will probably be ignored.  All bug reports should
be filed under the Samba 3.3 product in the project's Bugzilla
database (https://bugzilla.samba.org/).


======================================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
======================================================================

