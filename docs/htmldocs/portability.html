<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Portability</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REL="HOME"
TITLE="SAMBA Project Documentation"
HREF="samba-howto-collection.html"><LINK
REL="UP"
TITLE="Appendixes"
HREF="appendixes.html"><LINK
REL="PREVIOUS"
TITLE="Migration from NT4 PDC to Samba-3 PDC"
HREF="nt4migration.html"><LINK
REL="NEXT"
TITLE="Samba and other CIFS clients"
HREF="other-clients.html"></HEAD
><BODY
CLASS="CHAPTER"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>SAMBA Project Documentation</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="nt4migration.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="other-clients.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="CHAPTER"
><H1
><A
NAME="PORTABILITY"
></A
>Chapter 29. Portability</H1
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
>29.1. <A
HREF="portability.html#AEN4444"
>HPUX</A
></DT
><DT
>29.2. <A
HREF="portability.html#AEN4450"
>SCO Unix</A
></DT
><DT
>29.3. <A
HREF="portability.html#AEN4454"
>DNIX</A
></DT
><DT
>29.4. <A
HREF="portability.html#AEN4483"
>RedHat Linux Rembrandt-II</A
></DT
><DT
>29.5. <A
HREF="portability.html#AEN4489"
>AIX</A
></DT
><DT
>29.6. <A
HREF="portability.html#AEN4495"
>Solaris</A
></DT
></DL
></DIV
><P
>Samba works on a wide range of platforms but the interface all the 
platforms provide is not always compatible. This chapter contains 
platform-specific information about compiling and using samba.</P
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN4444"
>29.1. HPUX</A
></H1
><P
>HP's implementation of supplementary groups is, er, non-standard (for
hysterical reasons).  There are two group files, /etc/group and
/etc/logingroup; the system maps UIDs to numbers using the former, but
initgroups() reads the latter.  Most system admins who know the ropes
symlink /etc/group to /etc/logingroup (hard link doesn't work for reasons
too stupid to go into here).  initgroups() will complain if one of the
groups you're in in /etc/logingroup has what it considers to be an invalid
ID, which means outside the range [0..UID_MAX], where UID_MAX is (I think)
60000 currently on HP-UX.  This precludes -2 and 65534, the usual 'nobody'
GIDs.</P
><P
>If you encounter this problem, make sure that the programs that are failing 
to initgroups() be run as users not in any groups with GIDs outside the 
allowed range.</P
><P
>This is documented in the HP manual pages under setgroups(2) and passwd(4).</P
><P
>On HPUX you must use gcc or the HP Ansi compiler. The free compiler
that comes with HP-UX is not Ansi compliant and cannot compile
Samba.</P
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN4450"
>29.2. SCO Unix</A
></H1
><P
> 
If you run an old version of  SCO Unix then you may need to get important 
TCP/IP patches for Samba to work correctly. Without the patch, you may 
encounter corrupt data transfers using samba.</P
><P
>The patch you need is UOD385 Connection Drivers SLS. It is available from
SCO (ftp.sco.com, directory SLS, files uod385a.Z and uod385a.ltr.Z).</P
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN4454"
>29.3. DNIX</A
></H1
><P
>DNIX has a problem with seteuid() and setegid(). These routines are
needed for Samba to work correctly, but they were left out of the DNIX
C library for some reason.</P
><P
>For this reason Samba by default defines the macro NO_EID in the DNIX
section of includes.h. This works around the problem in a limited way,
but it is far from ideal, some things still won't work right.</P
><P
> 
To fix the problem properly you need to assemble the following two
functions and then either add them to your C library or link them into
Samba.</P
><P
> 
put this in the file <TT
CLASS="FILENAME"
>setegid.s</TT
>:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>        .globl  _setegid
_setegid:
        moveq   #47,d0
        movl    #100,a0
        moveq   #1,d1
        movl    4(sp),a1
        trap    #9
        bccs    1$
        jmp     cerror
1$:
        clrl    d0
        rts</PRE
></P
><P
>put this in the file <TT
CLASS="FILENAME"
>seteuid.s</TT
>:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>        .globl  _seteuid
_seteuid:
        moveq   #47,d0
        movl    #100,a0
        moveq   #0,d1
        movl    4(sp),a1
        trap    #9
        bccs    1$
        jmp     cerror
1$:
        clrl    d0
        rts</PRE
></P
><P
>after creating the above files you then assemble them using</P
><P
><B
CLASS="COMMAND"
>as seteuid.s</B
></P
><P
><B
CLASS="COMMAND"
>as setegid.s</B
></P
><P
>that should produce the files <TT
CLASS="FILENAME"
>seteuid.o</TT
> and 
<TT
CLASS="FILENAME"
>setegid.o</TT
></P
><P
>then you need to add these to the LIBSM line in the DNIX section of
the Samba Makefile. Your LIBSM line will then look something like this:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>LIBSM = setegid.o seteuid.o -ln</PRE
></P
><P
> 
You should then remove the line:</P
><P
><PRE
CLASS="PROGRAMLISTING"
>#define NO_EID</PRE
></P
><P
>from the DNIX section of <TT
CLASS="FILENAME"
>includes.h</TT
></P
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN4483"
>29.4. RedHat Linux Rembrandt-II</A
></H1
><P
>By default RedHat Rembrandt-II during installation adds an
entry to /etc/hosts as follows:
<PRE
CLASS="PROGRAMLISTING"
>	127.0.0.1 loopback "hostname"."domainname"</PRE
></P
><P
>This causes Samba to loop back onto the loopback interface.
The result is that Samba fails to communicate correctly with
the world and therefor may fail to correctly negotiate who
is the master browse list holder and who is the master browser.</P
><P
>Corrective Action:	Delete the entry after the word loopback
	in the line starting 127.0.0.1</P
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN4489"
>29.5. AIX</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="AEN4491"
>29.5.1. Sequential Read Ahead</A
></H2
><P
>Disabling Sequential Read Ahead using <KBD
CLASS="USERINPUT"
>vmtune -r 0</KBD
> improves 
samba performance significally.</P
></DIV
></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="AEN4495"
>29.6. Solaris</A
></H1
><P
>Some people have been experiencing problems with F_SETLKW64/fcntl 
when running samba on solaris. The built in file locking mechanism was
not scalable. Performance would degrade to the point where processes would
get into loops of trying to lock a file. It woul try a lock, then fail,
then try again. The lock attempt was failing before the grant was
occurring. So the visible manifestation of this would be a handful of
processes stealing all of the CPU, and when they were trussed they would
be stuck if F_SETLKW64 loops.</P
><P
>Sun released patches for Solaris 2.6, 8, and 9. The patch for Solaris 7
has not been released yet.</P
><P
>The patch revision for 2.6 is 105181-34
for 8 is 108528-19
and for 9 is 112233-04</P
><P
>After the install of these patches it is recommended to reconfigure
and rebuild samba.</P
><P
>Thanks to Joe Meslovich for reporting</P
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="nt4migration.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="samba-howto-collection.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="other-clients.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Migration from NT4 PDC to Samba-3 PDC</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="appendixes.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Samba and other CIFS clients</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>