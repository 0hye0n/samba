#!/usr/bin/env python

def configure(conf):
    if conf.CHECK_CFLAGS('-Wp,-E,-lang-asm', '') and conf.env['SYSTEM_UNAME_MACHINE'] == 'x86_64':
        conf.DEFINE('HAVE_AESNI_INTEL', 1)

def build(bld):
    if not bld.CONFIG_SET('HAVE_AESNI_INTEL'):
        return

    bld.SAMBA_LIBRARY('aesni-intel',
        source='aesni-intel_asm.c',
        cflags='-Wp,-E,-lang-asm',
        private_library=True)
