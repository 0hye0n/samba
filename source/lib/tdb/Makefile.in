#
# Makefile for tdb directory
#

CFLAGS = -DTDB_DEBUG -g -Iinclude
CC = @CC@
prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
includedir = @includedir@
libdir = @libdir@

PROGS = bin/tdbtool bin/tdbtorture
TDB_OBJ = common/tdb.o common/spinlock.o

all: $(PROGS)

install: all
	cp $(PROGS) $(bindir)
	cp include/tdb.h $(includedir)
	cp tdb.pc $(libdir)/pkgconfig

bin/tdbtest: tools/tdbtest.o $(TDB_OBJ)
	$(CC) $(CFLAGS) -o bin/tdbtest tools/tdbtest.o $(TDB_OBJ) -lgdbm

bin/tdbtool: tools/tdbtool.o $(TDB_OBJ)
	$(CC) $(CFLAGS) -o bin/tdbtool tools/tdbtool.o $(TDB_OBJ)

bin/tdbtorture: tools/tdbtorture.o $(TDB_OBJ)
	$(CC) $(CFLAGS) -o bin/tdbtorture tools/tdbtorture.o $(TDB_OBJ)

bin/tdbdump: tools/tdbdump.o $(TDB_OBJ)
	$(CC) $(CFLAGS) -o bin/tdbdump tools/tdbdump.o $(TDB_OBJ)

bin/tdbbackup: tools/tdbbackup.o $(TDB_OBJ)
	$(CC) $(CFLAGS) -o bin/tdbbackup tools/tdbbackup.o $(TDB_OBJ)

clean:
	rm -f $(PROGS) common/*.o tools/*.o *~ *.bak */*~ */*.bak *% core test.db test.tdb test.gdbm
