#!/usr/bin/env python

bld.SAMBA_SUBSYSTEM('service',
	source='service.c service_stream.c service_named_pipe.c service_task.c',
	autoproto='service_proto.h',
	deps='tevent MESSAGING samba_socket RPC_NDR_IRPC NDR_NAMED_PIPE_AUTH NAMED_PIPE_AUTH_TSTREAM gssapi CREDENTIALS LIBTSOCKET LIBSAMBA_TSOCKET process_model'
	)


bld.SAMBA_SUBSYSTEM('PIDFILE',
	source='pidfile.c',
        deps='talloc',
	autoproto='pidfile.h'
	)


bld.SAMBA_BINARY('samba',
	source='server.c',
	manpages='samba.8',
	subsystem_name='service',
	deps='''libevents process_model service libsamba-hostconfig libsamba-util POPT_SAMBA PIDFILE
                popt gensec registry ntptr ntvfs share CLUSTER DCESRV COMMON_SCHANNELDB SECRETS''',
	pyembed=True,
	install_path='${SBINDIR}'
	)




bld.SAMBA_MODULE('process_model_single',
	source='process_single.c',
	subsystem='process_model',
	init_function='process_model_single_init',
	internal_module=True
	)


bld.SAMBA_MODULE('process_model_standard',
	source='process_standard.c',
	subsystem='process_model',
	init_function='process_model_standard_init',
	deps='libevents LDBSAMBA'
	)


bld.SAMBA_MODULE('process_model_thread',
	source='process_thread.c',
	subsystem='process_model',
	init_function='process_model_thread_init',
	enabled=False,
	deps='pthread'
	)


bld.SAMBA_MODULE('process_model_prefork',
	source='process_prefork.c',
	subsystem='process_model',
	init_function='process_model_prefork_init',
	deps='libevents'
	)

bld.SAMBA_MODULE('process_model_onefork',
	source='process_onefork.c',
	subsystem='process_model',
	init_function='process_model_onefork_init',
	deps='libevents'
	)


bld.SAMBA_SUBSYSTEM('process_model',
	source='process_model.c',
	autoproto='process_model_proto.h',
	deps='libsamba-util libsamba-hostconfig'
	)

